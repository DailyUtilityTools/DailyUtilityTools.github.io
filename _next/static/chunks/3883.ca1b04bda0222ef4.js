"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3883],{33883:(e,t,l)=>{l.r(t),l.d(t,{default:()=>M});var r=l(37876),i=l(14232),n=l(49106),a=l(1521),s=l(76686),o=l(82702),c=l(87210),u=l(9092),d=l(53019),A=l(99358),h=l(75283),p=l(81393),x=l(49843),f=l(25923),g=l(61001),m=l(47103),b=l(75087);let v=(0,l(40925).A)((0,r.jsx)("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"}),"Verified");function y(e,t){let l=e[t],[r,i]=function(e,t){if(e[t]<128)return[e[t],t+1];let l=127&e[t],r=0;for(let i=0;i<l;i++)r=r<<8|e[t+1+i];return[r,t+1+l]}(e,t+1);return{tag:l,value:e.slice(i,i+r),next:i+r}}let C={"2.5.4.3":"CN","2.5.4.6":"C","2.5.4.7":"L","2.5.4.8":"ST","2.5.4.10":"O","2.5.4.11":"OU","1.2.840.113549.1.9.1":"emailAddress","2.5.29.17":"SAN","2.5.29.19":"BasicConstraints","2.5.29.15":"KeyUsage","2.5.29.37":"ExtKeyUsage","2.5.29.14":"SubjectKeyIdentifier","2.5.29.35":"AuthorityKeyIdentifier","2.5.29.31":"CRL Distribution Points","1.3.6.1.5.5.7.1.1":"Authority Info Access","1.2.840.113549.1.1.11":"sha256WithRSAEncryption","1.2.840.113549.1.1.5":"sha1WithRSAEncryption","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.10045.4.3.2":"ecdsaWithSHA256","1.2.840.10045.2.1":"EC Public Key","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.2.840.10045.3.1.7":"prime256v1"};function j(e){let t=[];t.push(Math.floor(e[0]/40)),t.push(e[0]%40);let l=0;for(let r=1;r<e.length;r++)l=l<<7|127&e[r],(128&e[r])==0&&(t.push(l),l=0);return t.join(".")}function w(e){return new TextDecoder().decode(e)}function S(e){let t=w(e);if(15===t.length)return`${t.slice(0,4)}-${t.slice(4,6)}-${t.slice(6,8)} ${t.slice(8,10)}:${t.slice(10,12)}:${t.slice(12,14)} UTC`;let l=parseInt(t.slice(0,2))>=50?"19":"20";return`${l}${t.slice(0,2)}-${t.slice(2,4)}-${t.slice(4,6)} ${t.slice(6,8)}:${t.slice(8,10)}:${t.slice(10,12)} UTC`}function E(e){let t=[],l=0;for(;l<e.length;){let r=y(e,l);l=r.next;let i=0;for(;i<r.value.length;){let e=y(r.value,i);i=e.next;let l=0,n=y(e.value,l);l=n.next;let a=j(n.value),s=C[a]||a,o=w(y(e.value,l).value);t.push(`${s}=${o}`)}}return t.join(", ")}async function D(e){let t=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join(":").toUpperCase()}async function I(e){let t=e.replace(/-----[A-Z ]+-----/g,"").replace(/\s/g,"");if(!t)throw Error("No PEM data found");let l=function(e){let t=atob(e),l=new Uint8Array(t.length);for(let e=0;e<t.length;e++)l[e]=t.charCodeAt(e);return l}(t),r=y(l,0),i=y(r.value,0),n=0,a=i.value,s="v1";if(160===a[n]){let e=y(a,n);n=e.next;let t=y(e.value,0);s=`v${t.value[0]+1}`}let o=y(a,n);n=o.next;let c=Array.from(o.value).map(e=>e.toString(16).padStart(2,"0")).join(":"),u=y(a,n);n=u.next;let d=y(u.value,0),A=C[j(d.value)]||j(d.value),h=y(a,n);n=h.next;let p=E(h.value),x=y(a,n);n=x.next;let f=0,g=y(x.value,f);f=g.next;let m=y(x.value,f),b=S(g.value),v=S(m.value),w=y(a,n);n=w.next;let I=E(w.value),T=y(a,n),M=y(T.value,0),N=y(M.value,0);return{subject:I,issuer:p,validFrom:b,validTo:v,serialNumber:c,signatureAlgorithm:A,publicKeyAlgorithm:C[j(N.value)]||j(N.value),version:s,fingerprint:await D(l),raw:t}}let T=`-----BEGIN CERTIFICATE-----
MIICpDCCAYwCCQDU+pQ4pHgSpDANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDDAls
b2NhbGhvc3QwHhcNMjMwMTAxMDAwMDAwWhcNMjQwMTAxMDAwMDAwWjAUMRIwEAYD
VQQDDAlsb2NhbGhvc3QwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQC7
o4qne60TB3wolBIYnTbwJJJ2eFnPrqJEADEYEnta+LMJKA+g7K5Ssmn+LmUe0PW
-----END CERTIFICATE-----`;function M(){(0,n.A)();let[e,t]=(0,i.useState)(""),[l,y]=(0,i.useState)(null),[C,j]=(0,i.useState)(""),[w,S]=(0,i.useState)(!1),[E,D]=(0,i.useState)(!1),M=(0,i.useCallback)(async(t=e)=>{if(t.trim()){S(!0),j(""),y(null);try{let e=await I(t.trim());y(e)}catch(e){j("Failed to decode certificate: "+e.message)}finally{S(!1)}}},[e]),N=!!l&&new Date().toISOString()>l.validTo.replace(" ","T").replace(" UTC","Z"),$=l?new Date(l.validTo.replace(" UTC"," +0000")):null,U=$?Math.ceil(($.getTime()-Date.now())/864e5):null,k=l?[["Version",l.version],["Subject",l.subject],["Issuer",l.issuer],["Serial Number",l.serialNumber],["Signature Algorithm",l.signatureAlgorithm],["Public Key Algorithm",l.publicKeyAlgorithm],["Valid From",l.validFrom],["Valid To",l.validTo],["SHA-256 Fingerprint",l.fingerprint]]:[];return(0,r.jsxs)(a.A,{maxWidth:"lg",sx:{py:4},children:[(0,r.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,r.jsx)(b.A,{color:"primary"}),(0,r.jsx)(o.A,{variant:"h4",fontWeight:700,children:"Certificate Decoder"})]}),(0,r.jsx)(o.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Decode X.509 PEM certificates and inspect subject, issuer, validity, key algorithm, and fingerprint. All processing is done locally."}),C&&(0,r.jsx)(c.A,{severity:"error",sx:{mb:2},children:C}),(0,r.jsxs)(u.A,{variant:"outlined",sx:{mb:2},children:[(0,r.jsxs)(s.A,{sx:{px:2,py:1,borderBottom:1,borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(o.A,{variant:"subtitle2",fontWeight:700,children:"PEM Input"}),(0,r.jsxs)(s.A,{sx:{display:"flex",gap:1},children:[(0,r.jsx)(d.A,{size:"small",onClick:()=>{t(T),M(T)},children:"Load Sample"}),(0,r.jsx)(A.A,{size:"small",onClick:()=>{t(""),y(null),j("")},children:(0,r.jsx)(m.A,{fontSize:"small"})})]})]}),(0,r.jsx)(s.A,{component:"textarea",value:e,onChange:e=>t(e.target.value),placeholder:`-----BEGIN CERTIFICATE-----
...
-----END CERTIFICATE-----`,rows:10,sx:{width:"100%",p:2,border:"none",outline:"none",resize:"vertical",fontFamily:"monospace",fontSize:"0.82rem",lineHeight:1.5,bgcolor:"background.paper",color:"text.primary",boxSizing:"border-box"}})]}),(0,r.jsx)(d.A,{variant:"contained",onClick:()=>M(),disabled:!e.trim()||w,sx:{mb:3},children:w?"Decodingâ€¦":"Decode Certificate"}),l&&(0,r.jsxs)(u.A,{variant:"outlined",children:[(0,r.jsxs)(s.A,{sx:{px:2,py:1.5,borderBottom:1,borderColor:"divider",display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[(0,r.jsx)(v,{color:N?"error":"success",fontSize:"small"}),(0,r.jsx)(o.A,{variant:"subtitle1",fontWeight:700,children:"Certificate Details"}),null!==U&&(0,r.jsx)(h.A,{size:"small",label:N?"EXPIRED":`${U} days left`,color:N?"error":U<30?"warning":"success"})]}),(0,r.jsx)(p.A,{size:"small",children:(0,r.jsx)(x.A,{children:k.map(([e,t])=>(0,r.jsxs)(f.A,{sx:{"&:last-child td":{border:0}},children:[(0,r.jsx)(g.A,{sx:{fontWeight:700,width:220,whiteSpace:"nowrap",color:"text.secondary",fontSize:"0.82rem"},children:e}),(0,r.jsx)(g.A,{sx:{fontFamily:"monospace",fontSize:"0.82rem",wordBreak:"break-all"},children:t})]},e))})})]})]})}}}]);