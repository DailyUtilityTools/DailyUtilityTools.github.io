(()=>{var e,t,a,r,n,o,s={70926:(e,t,a)=>{"use strict";var r=a(70375);class n{constructor(e){this.cacheName=e}async getRootDir(){let e=await navigator.storage.getDirectory();return await e.getDirectoryHandle(this.cacheName,{create:!0})}async getFileHandle(e,t=!1){try{let a=await this.getRootDir(),r=new URL(e),n=(r.hostname+r.pathname).replace(/[^a-zA-Z0-9.-]/g,"_");return await a.getFileHandle(n,{create:t})}catch(e){if(!t)return null;throw e}}async match(e,t){let a="string"==typeof e?e:e.url,r=await this.getFileHandle(a,!1);if(r)try{let e=await r.getFile();return new Response(e,{headers:{"Content-Type":"application/octet-stream","Content-Length":e.size.toString()}})}catch(e){return}}async put(e,t){let a="string"==typeof e?e:e.url;if(200!==t.status)return;let r=await this.getFileHandle(a,!0),n=await r.createWritable(),o=t.clone();try{await o.body.pipeTo(n)}catch(e){console.error("OPFS Write Error:",e)}}}if("storage"in navigator&&"getDirectory"in navigator.storage){let e=caches.open.bind(caches);caches.open=async function(t){return"transformers-cache"===t?new n(t):e(t)},console.log("OPFS Cache Proxy Initialized for Transformers.js")}else console.warn("OPFS Not Supported - Falling back to volatile Cache API");async function o(){try{if(!await navigator.gpu.requestAdapter())throw Error("WebGPU is not supported (no adapter found)")}catch(e){self.postMessage({status:"error",data:e.toString()})}}class s{static{this.model_id="onnx-community/Qwen3-0.6B-ONNX"}static async getInstance(e=null){return this.tokenizer??=r.v6I.from_pretrained(this.model_id,{progress_callback:e}),this.model??=r.W6E.from_pretrained(this.model_id,{dtype:"q4f16",device:"webgpu",progress_callback:e}),Promise.all([this.tokenizer,this.model])}}let i=new r.dYU;async function c({messages:e,reasonEnabled:t}){let a,n,[o,c]=await s.getInstance(),l=o.apply_chat_template(e,{add_generation_prompt:!0,return_dict:!0,enable_thinking:t}),[p,u]=o.encode("<think></think>",{add_special_tokens:!1}),d="answering",f=0,g=new r.T1P(o,{skip_prompt:!0,skip_special_tokens:!0,callback_function:e=>{self.postMessage({status:"update",output:e,tps:n,numTokens:f,state:d})},token_callback_function:e=>{switch(a??=performance.now(),f++>0&&(n=f/(performance.now()-a)*1e3),Number(e[0])){case p:d="thinking";break;case u:d="answering"}console.log(d,e,o.decode(e))}});self.postMessage({status:"start"});let{sequences:h}=await c.generate({...l,do_sample:!0,top_k:20,temperature:t?.6:.7,repetition_penalty:1.15,max_new_tokens:4096,streamer:g,stopping_criteria:i,return_dict_in_generate:!0}),y=o.batch_decode(h,{skip_special_tokens:!0});self.postMessage({status:"complete",output:y})}async function l(){self.postMessage({status:"loading",data:"Loading model..."});let[e,t]=await s.getInstance(e=>{self.postMessage(e)});await new Promise(e=>setTimeout(e,2e3)),self.postMessage({status:"loading",data:"Compiling shaders and warming up model..."});let a=e("a");await t.generate({...a,max_new_tokens:1}),self.postMessage({status:"ready"})}self.addEventListener("message",async e=>{let{type:t,data:a}=e.data;switch(t){case"check":o();break;case"load":l();break;case"generate":i.reset(),c(a);break;case"interrupt":i.interrupt();break;case"reset":i.reset()}})}},i={};function c(e){var t=i[e];if(void 0!==t)return t.exports;var a=i[e]={exports:{}},r=!0;try{s[e](a,a.exports,c),r=!1}finally{r&&delete i[e]}return a.exports}c.m=s,c.x=()=>{var e=c.O(void 0,[6929,1091,4322],()=>c(70926));return c.O(e)},e=[],c.O=(t,a,r,n)=>{if(a){n=n||0;for(var o=e.length;o>0&&e[o-1][2]>n;o--)e[o]=e[o-1];e[o]=[a,r,n];return}for(var s=1/0,o=0;o<e.length;o++){for(var[a,r,n]=e[o],i=!0,l=0;l<a.length;l++)(!1&n||s>=n)&&Object.keys(c.O).every(e=>c.O[e](a[l]))?a.splice(l--,1):(i=!1,n<s&&(s=n));if(i){e.splice(o--,1);var p=r();void 0!==p&&(t=p)}}return t},c.d=(e,t)=>{for(var a in t)c.o(t,a)&&!c.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce((t,a)=>(c.f[a](e,t),t),[])),c.u=e=>"static/chunks/"+(({1091:"ab3d95df",6929:"3b47c6e6"})[e]||e)+"."+({1091:"6f3717586955d336",4322:"f235457c7028990f",6929:"23defc940dda8019"})[e]+".js",c.miniCssF=e=>{},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.U=function(e){var t=new URL(e,"x:/"),a={};for(var r in t)a[r]=t[r];for(var r in a.href=e,a.pathname=e.replace(/[?#].*/,""),a.origin=a.protocol="",a.toString=a.toJSON=()=>e,a)Object.defineProperty(this,r,{enumerable:!0,configurable:!0,value:a[r]})},c.U.prototype=URL.prototype,c.tt=()=>(void 0===t&&(t={createScriptURL:e=>e},"u">typeof trustedTypes&&trustedTypes.createPolicy&&(t=trustedTypes.createPolicy("nextjs#bundler",t))),t),c.tu=e=>c.tt().createScriptURL(e),c.p="/_next/",a={926:1},c.f.i=(e,t)=>{a[e]||importScripts(c.tu(c.p+c.u(e)))},n=(r=self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push.bind(r),r.push=e=>{var[t,r,o]=e;for(var s in r)c.o(r,s)&&(c.m[s]=r[s]);for(o&&o(c);t.length;)a[t.pop()]=1;n(e)},o=c.x,c.x=()=>Promise.all([6929,1091,4322].map(c.e,c)).then(o),_N_E=c.x()})();