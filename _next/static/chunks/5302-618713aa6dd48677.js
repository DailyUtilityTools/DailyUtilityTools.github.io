"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5302],{45302:(e,t,a)=>{a.r(t),a.d(t,{default:()=>V});var r=a(37876),l=a(14232),i=a(49106),o=a(9092),n=a(76686),s=a(82702),c=a(75283),d=a(83621),x=a(84252),u=a(79850),h=a(95927),m=a(1521),g=a(47399),p=a(39852),y=a(92181),f=a(53019),b=a(87210),j=a(76815),A=a(51396),S=a(29472),v=a(69750),C=a(45342),w=a(5961),k=a(29351),L=a(62753),P=a(75135),z=a(33542),N=a(29190),M=a(22568),O=a(53820),W=a(83423),F=a(37085),T=a.n(F);let E=(0,l.lazy)(()=>Promise.all([a.e(8220),a.e(1024)]).then(a.bind(a,71024)));function D(e,t=""){if(Array.isArray(e))return e.flatMap(e=>"object"==typeof e&&null!==e?[R(e,t)]:[]);for(let a of Object.keys(e||{}))if(Array.isArray(e[a])&&e[a].length>0&&"object"==typeof e[a][0])return D(e[a],t?`${t}.${a}`:a);return[R(e,t)]}function R(e,t=""){let a={};return!function e(t,r){if(null==t){a[r]=t;return}if(Array.isArray(t)){a[r]=t.join(", ");return}if("object"==typeof t)for(let a of Object.keys(t))e(t[a],r?`${r}.${a}`:a);else a[r]=t}(e,t),a}function K(e){return e.length?Object.keys(e[0]).filter(t=>e.slice(0,10).some(e=>void 0!==e[t]&&""!==e[t]&&!isNaN(Number(e[t])))):[]}function I(e){return e.length?Object.keys(e[0]).filter(t=>!K(e).includes(t)):[]}function $(e,t){let a=[];for(let r=1;r<e.length-1;r++)e[r]>e[r-1]&&e[r]>e[r+1]?a.push({coord:[t[r],e[r]],name:"▲ Peak",symbol:"pin",symbolSize:36,itemStyle:{color:"#ef5350"}}):e[r]<e[r-1]&&e[r]<e[r+1]&&a.push({coord:[t[r],e[r]],name:"▼ Trough",symbol:"pin",symbolSize:36,itemStyle:{color:"#42a5f5"}});return a}let _={default:{bg:"transparent",textColor:"#333",palette:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gridColor:"rgba(0,0,0,0.1)"},dark:{bg:"#1a1a2e",textColor:"#eee",palette:["#60a5fa","#34d399","#f59e0b","#f87171","#a78bfa","#fb923c","#2dd4bf","#e879f9","#94a3b8"],gridColor:"rgba(255,255,255,0.1)"},highcontrast:{bg:"#000",textColor:"#fff",palette:["#ff0","#0f0","#0ff","#f0f","#f90","#f00","#fff","#9f0","#0af"],gridColor:"rgba(255,255,255,0.3)"},print:{bg:"#fff",textColor:"#000",palette:["#444","#888","#ccc","#000","#666","#aaa","#222","#777","#bbb"],gridColor:"rgba(0,0,0,0.15)"}},B=[{id:"line",label:"Line",icon:"\uD83D\uDCC8"},{id:"bar",label:"Bar",icon:"\uD83D\uDCCA"},{id:"area",label:"Area",icon:"\uD83C\uDFD4️"},{id:"pie",label:"Pie",icon:"\uD83E\uDD67"},{id:"donut",label:"Donut",icon:"\uD83C\uDF69"},{id:"scatter",label:"Scatter",icon:"\uD83D\uDD35"},{id:"heatmap",label:"Heatmap",icon:"\uD83C\uDF21️"},{id:"candlestick",label:"Candle",icon:"\uD83D\uDD6F️"},{id:"sankey",label:"Sankey",icon:"\uD83C\uDF0A"},{id:"radar",label:"Radar",icon:"\uD83D\uDD78️"},{id:"graph",label:"Network",icon:"\uD83D\uDD78"}];function J({rows:e,yKey:t}){let a=e.map(e=>Number(e[t])).filter(e=>!isNaN(e)),l=function(e){if(!e.length)return{mean:null,peak:null,trough:null,trend:"—",variance:"—",count:0};let t=e.reduce((e,t)=>e+t,0)/e.length,a=Math.max(...e),r=Math.min(...e),l=[...e].sort((e,t)=>e-t)[Math.floor(e.length/2)],i=0!==l?`${((a-l)/l*100).toFixed(1)}%`:"—",o=e.length,n=e.slice(0,Math.floor(o/2)),s=e.slice(Math.floor(o/2)),c=n.reduce((e,t)=>e+t,0)/(n.length||1),d=s.reduce((e,t)=>e+t,0)/(s.length||1);return{mean:+t.toFixed(3),peak:a,trough:r,trend:d>c?"↑ Upward":d<c?"↓ Downward":"→ Flat",variance:i,count:e.length}}(a);return((0,i.A)(),a.length&&t)?(0,r.jsxs)(o.A,{variant:"outlined",sx:{p:2,mt:2},children:[(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[(0,r.jsx)(N.A,{fontSize:"small",color:"primary"}),(0,r.jsx)(s.A,{variant:"subtitle2",fontWeight:700,children:"AI Insight Panel"}),(0,r.jsx)(c.A,{size:"small",label:"Client-side"})]}),(0,r.jsxs)(s.A,{variant:"body2",color:"text.secondary",sx:{mb:1},children:[(0,r.jsxs)("strong",{children:['"',t,'"']})," — ",l.count," data points."," ","Trend is ",(0,r.jsx)("strong",{children:l.trend}),"."," ","Peak is ",(0,r.jsx)("strong",{children:l.peak?.toLocaleString()})," and trough is ",(0,r.jsx)("strong",{children:l.trough?.toLocaleString()}),"."," ","Mean: ",(0,r.jsx)("strong",{children:l.mean?.toLocaleString()}),"."," ","Peak is ",(0,r.jsx)("strong",{children:l.variance})," above median."]})]}):null}let G={timeseries:{label:"Time Series (Line)",chartType:"line",data:JSON.stringify(Array.from({length:30},(e,t)=>({timestamp:`2026-${String(Math.floor(t/30*12)+1).padStart(2,"0")}-${String(t%28+1).padStart(2,"0")}`,value:Math.round(50+30*Math.sin(t/5)+15*Math.random()),category:t%3==0?"Server A":t%3==1?"Server B":"Server C"})),null,2)},sankey:{label:"Sankey / Flow",chartType:"sankey",data:JSON.stringify([{source:"Landing Page",target:"Login",weight:8400},{source:"Login",target:"Dashboard",weight:6200},{source:"Login",target:"Signup",weight:1800},{source:"Dashboard",target:"Reports",weight:3100},{source:"Dashboard",target:"Settings",weight:1400},{source:"Reports",target:"Export",weight:2100}],null,2)},scatter:{label:"Scatter / Heatmap",chartType:"scatter",data:JSON.stringify(Array.from({length:200},()=>({x_metric:Math.round(500*Math.random()),y_metric:Math.round(500*Math.random()),z_value:+Math.random().toFixed(2),label:`req_${Math.random().toString(36).slice(2,8)}`})),null,2)},candlestick:{label:"Candlestick (OHLC)",chartType:"candlestick",data:JSON.stringify(Array.from({length:20},(e,t)=>{let a=100+2*t+10*Math.random(),r=a+(Math.random()-.5)*20;return{timestamp:`2026-01-${String(t+1).padStart(2,"0")}`,open:+a.toFixed(2),close:+r.toFixed(2),high:+(Math.max(a,r)+5*Math.random()).toFixed(2),low:+(Math.min(a,r)-5*Math.random()).toFixed(2)}}),null,2)},radar:{label:"Radar / Spider",chartType:"radar",data:JSON.stringify([{axis:"Speed",value:90,entity:"Product A"},{axis:"Reliability",value:75,entity:"Product A"},{axis:"Cost",value:60,entity:"Product A"},{axis:"UX",value:85,entity:"Product A"},{axis:"Performance",value:70,entity:"Product A"},{axis:"Speed",value:60,entity:"Product B"},{axis:"Reliability",value:90,entity:"Product B"},{axis:"Cost",value:85,entity:"Product B"},{axis:"UX",value:65,entity:"Product B"},{axis:"Performance",value:80,entity:"Product B"}],null,2)}};function V(){let e=(0,i.A)(),t="dark"===e.palette.mode,N=(0,l.useRef)(null),F=(0,l.useRef)(null),[R,V]=(0,l.useState)(""),[U,H]=(0,l.useState)([]),[X,Y]=(0,l.useState)(""),[Z,q]=(0,l.useState)("line"),[Q,ee]=(0,l.useState)(t?"dark":"default"),[et,ea]=(0,l.useState)(!1),[er,el]=(0,l.useState)("OmniChart Viz"),[ei,eo]=(0,l.useState)("Generated by DailyUtilityTools"),[en,es]=(0,l.useState)({x:"",y:"",category:"",open:"",high:"",low:"",close:"",source:"",target:"",weight:"",axis:"",entity:"",z:""}),[ec,ed]=(0,l.useState)(0),[ex,eu]=(0,l.useState)(!1),eh=(0,l.useMemo)(()=>K(U),[U]),em=(0,l.useMemo)(()=>I(U),[U]),eg=(0,l.useMemo)(()=>U.length?Object.keys(U[0]):[],[U]);(0,l.useEffect)(()=>{U.length&&es(e=>{let t={...e};return Object.entries({x:em[0]||eg[0]||"",y:eh[0]||"",source:em.find(e=>e.toLowerCase().includes("source")||e.toLowerCase().includes("from"))||em[0]||"",target:em.find(e=>e.toLowerCase().includes("target")||e.toLowerCase().includes("to"))||em[1]||"",weight:eh.find(e=>e.toLowerCase().includes("weight")||e.toLowerCase().includes("value"))||eh[0]||"",axis:em.find(e=>e.toLowerCase().includes("axis")||"dimension"===e.toLowerCase())||em[0]||"",entity:em.find(e=>e.toLowerCase().includes("entity")||e.toLowerCase().includes("product")||e.toLowerCase().includes("group"))||em[1]||"",open:eg.find(e=>"open"===e.toLowerCase())||eh[0]||"",high:eg.find(e=>"high"===e.toLowerCase())||eh[1]||"",low:eg.find(e=>"low"===e.toLowerCase())||eh[2]||"",close:eg.find(e=>"close"===e.toLowerCase())||eh[3]||"",z:eh.find(e=>e.toLowerCase().includes("z")||e.toLowerCase().includes("intensity")||e.toLowerCase().includes("weight"))||eh[2]||eh[0]||""}).forEach(([e,a])=>{t[e]||"none"===t[e]||(t[e]=a)}),t})},[U,eg,eh,em]);let ep=(0,l.useCallback)(e=>{let t=e.trim();if(!t){H([]),Y("");return}Y("");try{if(t.startsWith("{")||t.startsWith("["))try{let e=JSON.parse(t);H(D(e));return}catch(e){if(t.endsWith("}")||t.endsWith("]"))throw Error(`JSON Error: ${e.message}`);return}if(t.includes(":"))try{let e=W.Hh(t);if(e&&"object"==typeof e)return void H(D(e))}catch{}if(t.includes(",")||t.includes("	")||t.includes(";")){let e=T().parse(t,{header:!0,dynamicTyping:!0,skipEmptyLines:!0});if(e.data.length&&Object.keys(e.data[0]).length>1)return void H(e.data)}Y("Unrecognized format. Please provide valid JSON, YAML, or CSV.")}catch(e){Y(e.message)}},[]);(0,l.useEffect)(()=>{let e=setTimeout(()=>{ep(R)},600);return()=>clearTimeout(e)},[R,ep]);let ey=(0,l.useCallback)(e=>{let t=new FileReader;t.onload=e=>{let t=e.target?.result;V(t),ep(t)},t.readAsText(e)},[ep]),ef=(0,l.useCallback)(e=>{e.preventDefault();let t=e.dataTransfer.files[0];t&&ey(t)},[ey]),eb=(0,l.useCallback)(e=>{let t=G[e];V(t.data),q(t.chartType),es({x:"",y:"",category:"",open:"",high:"",low:"",close:"",source:"",target:"",weight:"",axis:"",entity:"",z:""}),ep(t.data)},[ep]),ej=(0,l.useCallback)(()=>{try{let e=localStorage.getItem("omni-json-doc")||localStorage.getItem("jsonEditorContent");e?(V(e),ep(e)):alert("No JSON Editor data found in localStorage.")}catch{alert("Could not read from localStorage.")}},[ep]),eA=(0,l.useMemo)(()=>{if(!U.length)return null;try{return function(e,t,a,r,l,i,o){let n,s=_[o],c=i?"Arial":void 0,d={backgroundColor:s.bg,textStyle:{fontFamily:c,color:s.textColor},title:{text:r,subtext:l,textStyle:{color:s.textColor,fontFamily:c,fontSize:16},subtextStyle:{color:s.textColor,fontFamily:c}},tooltip:{trigger:"item"},animation:!0,toolbox:{feature:{saveAsImage:{show:!0},dataZoom:{show:!0},restore:{show:!0}}}},x=s.palette;if("pie"===e||"donut"===e){let r=a.category||Object.keys(t[0]||{})[0],l=a.y||K(t)[0]||"",i=t.map(e=>({name:e[r],value:Number(e[l])}));return{...d,color:x,series:[{type:"pie",radius:"donut"===e?["40%","70%"]:"60%",data:i,label:{fontFamily:c,color:s.textColor}}]}}if("sankey"===e){let e=a.source||"source",r=a.target||"target",l=a.weight||"weight",i=new Set;return t.forEach(t=>{i.add(String(t[e])),i.add(String(t[r]))}),{...d,color:x,series:[{type:"sankey",data:[...i].filter(Boolean).map(e=>({name:e})),links:t.map(t=>({source:String(t[e]),target:String(t[r]),value:Number(t[l])||1})),emphasis:{focus:"adjacency"},label:{color:s.textColor,fontFamily:c}}]}}if("radar"===e){let e=a.axis||"axis",r=a.y||"value",l=a.entity||"entity",i=[...new Set(t.map(t=>String(t[e])))],o=[...new Set(t.map(e=>String(e[l])))],n=Math.max(...t.map(e=>Number(e[r])||0),100);return{...d,color:x,legend:{data:o,textStyle:{color:s.textColor}},radar:{indicator:i.map(e=>({name:e,max:n})),axisName:{color:s.textColor,fontFamily:c}},series:[{type:"radar",data:o.map(a=>({name:a,value:i.map(i=>{let o=t.find(t=>t[e]===i&&t[l]===a);return o?Number(o[r]):0})}))}]}}if("graph"===e){let e=a.source||"source",r=a.target||"target",l=a.weight||"weight",i=new Set;return t.forEach(t=>{i.add(String(t[e])),i.add(String(t[r]))}),{...d,series:[{type:"graph",layout:"force",force:{repulsion:100,gravity:.1,edgeLength:[50,200]},nodes:[...i].filter(Boolean).map(e=>({name:e,symbolSize:28,label:{show:!0,fontFamily:c,color:s.textColor}})),edges:t.map(t=>({source:String(t[e]),target:String(t[r]),lineStyle:{width:Math.max(1,Number(t[l])/1e3)}})),roam:!0,emphasis:{focus:"adjacency"},color:x}]}}if("scatter"===e){let e=a.x||"x_metric",r=a.y||"y_metric",l=a.z||"z_value";return{...d,color:x,xAxis:{type:"value",axisLine:{lineStyle:{color:s.textColor}}},yAxis:{type:"value",axisLine:{lineStyle:{color:s.textColor}}},dataZoom:[{type:"inside"},{type:"slider"}],series:[{type:"scatter",data:t.map(t=>[Number(t[e]),Number(t[r]),Number(t[l])||1]),symbolSize:e=>Math.max(4,Math.min(20*(e[2]||1),40)),tooltip:{formatter:e=>`x: ${e.value[0]}<br/>y: ${e.value[1]}<br/>z: ${e.value[2]}`}}]}}if("heatmap"===e){let e=a.x||"x_metric",r=a.y||"y_metric",l=a.z||"z_value",i=[...new Set(t.map(t=>t[e]))],o=[...new Set(t.map(e=>e[r]))];return{...d,xAxis:{type:"category",data:i,axisLabel:{color:s.textColor}},yAxis:{type:"category",data:o,axisLabel:{color:s.textColor}},visualMap:{calculable:!0,orient:"horizontal",left:"center",bottom:"5%"},series:[{type:"heatmap",data:t.map(t=>[i.indexOf(t[e]),o.indexOf(t[r]),Number(t[l])||0]),label:{show:o.length<15}}]}}if("candlestick"===e){let e=a.x||"timestamp",r=a.open||"open",l=a.high||"high",i=a.low||"low",o=a.close||"close";return{...d,xAxis:{type:"category",data:t.map(t=>t[e]),axisLabel:{color:s.textColor}},yAxis:{scale:!0,axisLabel:{color:s.textColor}},dataZoom:[{type:"inside",start:0,end:100},{show:!0,type:"slider"}],series:[{type:"candlestick",data:t.map(e=>[Number(e[r]),Number(e[o]),Number(e[i]),Number(e[l])])}]}}let u=a.x||I(t)[0]||Object.keys(t[0]||{})[0]||"",h=a.y||K(t)[0]||"",m=a.category,g=[...new Set(t.map(e=>String(e[u])))];if(m&&"none"!==m)n=[...new Set(t.map(e=>String(e[m])))].map((a,r)=>{let l=t.filter(e=>String(e[m])===a),o=g.map(e=>{let t=l.find(t=>String(t[u])===e);return t?Number(t[h]):null}),n=o.filter(e=>null!==e),s=i&&("line"===e||"area"===e)?$(n,g.filter((e,t)=>null!==o[t])):[];return{name:a,type:"bar"===e?"bar":"line",areaStyle:"area"===e?{opacity:.3}:void 0,data:o,smooth:"bar"!==e,color:x[r%x.length],markPoint:s.length?{data:s}:void 0}});else{let a=g.map(e=>{let a=t.find(t=>String(t[u])===e);return a?Number(a[h]):null}),r=a.filter(e=>null!==e),l=i&&("line"===e||"area"===e)?$(r,g.filter((e,t)=>null!==a[t])):[];n=[{name:h,type:"bar"===e?"bar":"line",areaStyle:"area"===e?{opacity:.3}:void 0,data:a,smooth:"bar"!==e,markPoint:l.length?{data:l}:void 0}]}return{...d,color:x,grid:{left:"3%",right:"4%",bottom:"12%",containLabel:!0},legend:{textStyle:{color:s.textColor,fontFamily:c},bottom:0},xAxis:{type:"category",data:g,axisLabel:{color:s.textColor,fontFamily:c,rotate:30*(g.length>10)},splitLine:{lineStyle:{color:s.gridColor}}},yAxis:{type:"value",axisLabel:{color:s.textColor,fontFamily:c},splitLine:{lineStyle:{color:s.gridColor}}},dataZoom:[{type:"inside"},{type:"slider",bottom:30}],tooltip:{trigger:"axis"},series:n}}(Z,U,en,er,ei,et,et?"print":Q)}catch(e){return null}},[U,Z,en,er,ei,et,Q]),eS=(0,l.useCallback)(async()=>{eu(!0);try{let e=N.current?.getEchartsInstance();if(!e)return;let t=e.getDataURL({type:"png",pixelRatio:4,backgroundColor:_[et?"print":Q].bg||"#fff"}),a=document.createElement("a");a.href=t,a.download=`${er}.png`,a.click()}finally{eu(!1)}},[er,et,Q]),ev=(0,l.useCallback)(async()=>{eu(!0);try{let e=N.current?.getEchartsInstance();if(!e)return;let t=e.getDataURL({type:"svg"}),a=t.startsWith("data:image/svg")?atob(t.split(",")[1]):t,r=new Blob([a],{type:"image/svg+xml"}),l=document.createElement("a");l.href=URL.createObjectURL(r),l.download=`${er}.svg`,l.click()}catch{eS()}finally{eu(!1)}},[er,eS]),eC=(0,l.useCallback)(async()=>{eu(!0);try{let e=N.current?.getEchartsInstance();if(!e)return;let t=e.getDataURL({type:"png",pixelRatio:2,backgroundColor:"#ffffff"}),{default:r}=await Promise.all([a.e(5089),a.e(8220),a.e(7524)]).then(a.bind(a,74691)),l=new r,i=l.addSlide();i.addText(er,{x:.5,y:.2,fontSize:24,bold:!0,color:"363636"}),i.addText(ei,{x:.5,y:.7,fontSize:12,color:"888888"}),i.addImage({data:t,x:.5,y:1.1,w:9,h:5.5}),await l.writeFile({fileName:`${er}.pptx`})}finally{eu(!1)}},[er,ei]),ew=({label:e,fKey:t,nums:a})=>(0,r.jsxs)(d.A,{size:"small",sx:{minWidth:130},children:[(0,r.jsx)(x.A,{children:e}),(0,r.jsxs)(u.A,{value:en[t],label:e,onChange:e=>es(a=>({...a,[t]:e.target.value})),children:[(0,r.jsx)(h.A,{value:"",children:(0,r.jsx)("em",{children:"— auto —"})}),(a?eh:eg).map(e=>(0,r.jsx)(h.A,{value:e,children:e},e)),!a&&(0,r.jsx)(h.A,{value:"none",children:"None"})]})]}),ek=(()=>{let e=(0,r.jsx)(ew,{label:"Category",fKey:"category"},"cat");switch(Z){case"candlestick":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"Date/X",fKey:"x"}),(0,r.jsx)(ew,{label:"Open",fKey:"open",nums:!0}),(0,r.jsx)(ew,{label:"High",fKey:"high",nums:!0}),(0,r.jsx)(ew,{label:"Low",fKey:"low",nums:!0}),(0,r.jsx)(ew,{label:"Close",fKey:"close",nums:!0})]});case"sankey":case"graph":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"Source",fKey:"source"}),(0,r.jsx)(ew,{label:"Target",fKey:"target"}),(0,r.jsx)(ew,{label:"Weight",fKey:"weight",nums:!0})]});case"radar":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"Axis/Dimension",fKey:"axis"}),(0,r.jsx)(ew,{label:"Value",fKey:"y",nums:!0}),(0,r.jsx)(ew,{label:"Entity",fKey:"entity"})]});case"pie":case"donut":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"Label",fKey:"category"}),(0,r.jsx)(ew,{label:"Value",fKey:"y",nums:!0})]});case"scatter":case"heatmap":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"X",fKey:"x"}),(0,r.jsx)(ew,{label:"Y",fKey:"y"}),(0,r.jsx)(ew,{label:"Z / Intensity",fKey:"z",nums:!0})]});default:return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ew,{label:"X Axis",fKey:"x"}),(0,r.jsx)(ew,{label:"Y Axis",fKey:"y",nums:!0}),e]})}})();return(0,r.jsxs)(m.A,{maxWidth:"xl",sx:{py:3},children:[(0,r.jsxs)(n.A,{sx:{mb:3},children:[(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[(0,r.jsx)(M.A,{color:"primary",sx:{fontSize:32}}),(0,r.jsx)(s.A,{variant:"h4",fontWeight:800,sx:{background:"linear-gradient(90deg, #5470c6, #91cc75)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"OmniChart Viz"}),(0,r.jsx)(c.A,{size:"small",label:"WebGL-Powered",color:"primary",variant:"outlined"})]}),(0,r.jsx)(s.A,{variant:"body2",color:"text.secondary",children:"Raw Data → Boardroom-Ready Visuals. Supports JSON, CSV, YAML. 10 chart types. Export to PNG (4K), SVG, and editable PPTX."})]}),(0,r.jsxs)(n.A,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",lg:"row"}},children:[(0,r.jsx)(n.A,{sx:{width:{xs:"100%",lg:340},flexShrink:0},children:(0,r.jsxs)(o.A,{variant:"outlined",sx:{p:0,overflow:"hidden"},children:[(0,r.jsxs)(g.A,{value:ec,onChange:(e,t)=>ed(t),variant:"fullWidth",children:[(0,r.jsx)(p.A,{label:"Data"}),(0,r.jsx)(p.A,{label:"Chart"}),(0,r.jsx)(p.A,{label:"Export"})]}),0===ec&&(0,r.jsxs)(n.A,{sx:{p:2},children:[(0,r.jsxs)(n.A,{ref:F,onDrop:ef,onDragOver:e=>e.preventDefault(),onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".json,.csv,.yaml,.yml",e.onchange=e=>e.target.files?.[0]&&ey(e.target.files[0]),e.click()},sx:{border:`2px dashed ${e.palette.divider}`,borderRadius:2,p:2,textAlign:"center",cursor:"pointer",mb:1.5,"&:hover":{borderColor:"primary.main",bgcolor:(0,y.X4)(e.palette.primary.main,.03)},transition:"all 0.2s"},children:[(0,r.jsx)(P.A,{color:"action"}),(0,r.jsx)(s.A,{variant:"caption",display:"block",color:"text.secondary",children:"Drop JSON / CSV / YAML or click to browse"})]}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",display:"block",sx:{mb:.5},children:"Load sample:"}),(0,r.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:1.5},children:Object.entries(G).map(([e,t])=>(0,r.jsx)(c.A,{size:"small",label:t.label,onClick:()=>eb(e),clickable:!0},e))}),(0,r.jsx)(f.A,{size:"small",variant:"outlined",fullWidth:!0,onClick:ej,sx:{mb:1.5},children:"\uD83D\uDCCB Load from JSON Editor"}),(0,r.jsx)(n.A,{component:"textarea",value:R,onChange:e=>{V(e.target.value),ep(e.target.value)},placeholder:`Paste JSON array, CSV rows, or YAML list…`,rows:10,sx:{width:"100%",p:1.5,fontFamily:"monospace",fontSize:"0.78rem",border:`1px solid ${e.palette.divider}`,borderRadius:1,bgcolor:"background.paper",color:"text.primary",outline:"none",resize:"vertical",boxSizing:"border-box",display:"block"}}),X&&(0,r.jsx)(b.A,{severity:"error",sx:{mt:1},children:X}),U.length>0&&(0,r.jsxs)(s.A,{variant:"caption",color:"success.main",display:"block",sx:{mt:.5},children:["✓ ",U.length.toLocaleString()," rows detected \xb7 ",eg.length," fields"]})]}),1===ec&&(0,r.jsxs)(n.A,{sx:{p:2},children:[(0,r.jsx)(j.A,{size:"small",label:"Title",value:er,onChange:e=>el(e.target.value),fullWidth:!0,sx:{mb:1}}),(0,r.jsx)(j.A,{size:"small",label:"Subtitle",value:ei,onChange:e=>eo(e.target.value),fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",fontWeight:700,display:"block",sx:{mb:.5},children:"CHART TYPE"}),(0,r.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mb:2},children:B.map(e=>(0,r.jsx)(c.A,{label:`${e.icon} ${e.label}`,onClick:()=>q(e.id),variant:Z===e.id?"filled":"outlined",color:Z===e.id?"primary":"default",size:"small",clickable:!0},e.id))}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",fontWeight:700,display:"block",sx:{mb:.5},children:"FIELD MAPPING"}),(0,r.jsx)(n.A,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:ek}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",fontWeight:700,display:"block",sx:{mb:.5},children:"THEME"}),(0,r.jsx)(A.A,{size:"small",value:Q,exclusive:!0,onChange:(e,t)=>t&&ee(t),sx:{flexWrap:"wrap",mb:2},children:[["default","Default"],["dark","Dark"],["highcontrast","Hi-Con"],["print","Print"]].map(([e,t])=>(0,r.jsx)(S.A,{value:e,sx:{fontSize:"0.72rem"},children:t},e))}),(0,r.jsx)(v.A,{sx:{my:1}}),(0,r.jsx)(C.A,{control:(0,r.jsx)(w.A,{checked:et,onChange:e=>ea(e.target.checked)}),label:(0,r.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:[(0,r.jsx)(O.A,{fontSize:"small"}),(0,r.jsx)(s.A,{variant:"body2",fontWeight:700,children:"PPGT Mode"})]})}),et&&(0,r.jsx)(b.A,{severity:"info",sx:{mt:1,fontSize:"0.76rem"},children:"PPGT Mode: Transparent background \xb7 Arial font \xb7 Auto peak/valley annotations \xb7 Print-safe theme"})]}),2===ec&&(0,r.jsxs)(n.A,{sx:{p:2},children:[(0,r.jsx)(s.A,{variant:"subtitle2",fontWeight:700,gutterBottom:!0,children:"Export Options"}),(0,r.jsxs)(k.A,{spacing:1.5,children:[(0,r.jsx)(f.A,{variant:"contained",startIcon:(0,r.jsx)(z.A,{}),onClick:eS,disabled:!eA||ex,fullWidth:!0,children:ex?"⏳ Exporting…":"\uD83D\uDDBC️ PNG (4K Resolution)"}),(0,r.jsx)(f.A,{variant:"outlined",startIcon:(0,r.jsx)(z.A,{}),onClick:ev,disabled:!eA||ex,fullWidth:!0,children:"\uD83D\uDCD0 SVG (Vector)"}),(0,r.jsx)(f.A,{variant:"outlined",startIcon:(0,r.jsx)(z.A,{}),onClick:eC,disabled:!eA||ex,fullWidth:!0,sx:{borderColor:"#c43e1c",color:"#c43e1c","&:hover":{borderColor:"#a33517"}},children:"\uD83D\uDCCA PowerPoint (.pptx)"})]}),(0,r.jsx)(v.A,{sx:{my:2}}),(0,r.jsxs)(s.A,{variant:"caption",color:"text.secondary",children:["\uD83D\uDCA1 ",(0,r.jsx)("strong",{children:"PPGT Tip:"})," Enable PPGT Mode before exporting for transparent background, Arial font, and auto-annotated peaks — optimized for PowerPoint slides."]}),(0,r.jsx)(v.A,{sx:{my:2}}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",display:"block",fontWeight:700,gutterBottom:!0,children:"Data Schema Reference"}),[["Line/Bar/Area","{ timestamp, value, category }"],["Sankey/Network","{ source, target, weight }"],["Scatter/Heatmap","{ x_metric, y_metric, z_value }"],["Candlestick","{ timestamp, open, high, low, close }"],["Radar","{ axis, value, entity }"]].map(([e,t])=>(0,r.jsxs)(n.A,{sx:{mb:.5},children:[(0,r.jsx)(s.A,{variant:"caption",fontWeight:700,display:"block",children:e}),(0,r.jsx)(s.A,{variant:"caption",color:"text.secondary",fontFamily:"monospace",children:t})]},e))]})]})}),(0,r.jsxs)(n.A,{sx:{flex:1,minWidth:0},children:[U.length?eA?(0,r.jsxs)(o.A,{variant:"outlined",sx:{p:1,height:520,bgcolor:et?"transparent":void 0,border:et?"2px dashed":void 0,borderColor:et?"primary.main":void 0},children:[et&&(0,r.jsx)(c.A,{size:"small",label:"PPGT Mode Active",color:"primary",icon:(0,r.jsx)(O.A,{}),sx:{mb:.5}}),(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)(n.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",height:"90%"},children:(0,r.jsx)(L.A,{})}),children:(0,r.jsx)(E,{ref:N,option:eA,style:{height:et?480:490,width:"100%"},notMerge:!0,lazyUpdate:!1})})]}):(0,r.jsx)(b.A,{severity:"warning",children:"Could not render chart with current field mapping. Check the Chart tab to configure fields."}):(0,r.jsxs)(o.A,{variant:"outlined",sx:{height:480,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,bgcolor:(0,y.X4)(e.palette.primary.main,.02)},children:[(0,r.jsx)(M.A,{sx:{fontSize:64,color:"text.disabled"}}),(0,r.jsx)(s.A,{color:"text.secondary",variant:"h6",children:"Load data to start visualizing"}),(0,r.jsx)(n.A,{sx:{display:"flex",gap:1,flexWrap:"wrap",justifyContent:"center"},children:Object.entries(G).slice(0,4).map(([e,t])=>(0,r.jsxs)(f.A,{variant:"outlined",size:"small",onClick:()=>{eb(e),ed(1)},children:["\uD83D\uDCCA ",t.label]},e))})]}),U.length>0&&en.y&&["line","bar","area"].includes(Z)&&(0,r.jsx)(J,{rows:U,yKey:en.y}),U.length>0&&(0,r.jsxs)(o.A,{variant:"outlined",sx:{mt:2,p:2,maxHeight:180,overflow:"auto"},children:[(0,r.jsxs)(s.A,{variant:"caption",fontWeight:700,color:"text.secondary",display:"block",sx:{mb:.5},children:["Data Preview — ",U.length.toLocaleString()," rows \xb7 Showing first 5"]}),(0,r.jsx)(n.A,{component:"pre",sx:{fontFamily:"monospace",fontSize:"0.72rem",m:0,color:"text.primary"},children:JSON.stringify(U.slice(0,5),null,2)})]})]})]})]})}}}]);